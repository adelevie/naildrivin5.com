<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Naildrivin' &#10106;]]></title>
  <link href="http://www.naildrivin5.com/atom.xml" rel="self"/>
  <link href="http://www.naildrivin5.com/"/>
  <updated>2013-01-04T18:38:12-05:00</updated>
  <id>http://www.naildrivin5.com/</id>
  <author>
    <name><![CDATA[David Bryant Copeland]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[&#10106;&#10144; DCI vs Just Making Classes]]></title>
    <link href="http://www.naildrivin5.com/blog/2013/01/02/dci-vs-just-making-classes.html"/>
    <updated>2013-01-02T15:11:00-05:00</updated>
    <id>http://www.naildrivin5.com/blog/2013/01/02/dci-vs-just-making-classes</id>
    <content type="html"><![CDATA[<p>There&#8217;s been lots of talk about <a href="http://en.wikipedia.org/wiki/Data,_Context,_and_Interaction">DCI</a> in the Ruby community lately.  As I mentioned, I am only partway through Jim
Gay&#8217;s <a href="http://clean-ruby.com">unfinished book on the subject</a>, but I ran across a blog post that had a more substantial example in it.</p>

<p>Titled <a href="http://rebo.ruhoh.com/why-dci-contexts/">Why DCI Contexts?</a>, someone named <a href="http://rebo.ruhoh.com/about/">rebo</a>, shows a starting point of &#8220;normal&#8221; code, then &#8220;DCIzes&#8221; it, then walks through adding new features to the system.  It&#8217;s a bit long, but his explanation is great, and it shows a <em>lot</em> more than just calling <code>.extend</code> on an object - he clearly demonstrates how roles and contexts are used to implement specific use cases.</p>

<p>Despite the deftness of his explalnation, I find the result code entirely too complex, thanks to confusing abstractions, a
needless DSL and leaky abstractions.  It would all have been a lot simpler if he Just Used Classes&reg;</p>

<p>Let&#8217;s see why.</p>

<!-- more -->


<p>In rebo&#8217;s post, he has a basic domain of a <code>User</code>, a <code>Product</code>, an <code>Invoice</code>, and <code>Accounts</code> (which groups invoices).  The classes he creates for them are reasonable structs - they just hold data and have no real methods.  He then shows the implementation of a basic use case - when someone buys something an invoice is created and added to their accounts.  Here&#8217;s the code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PurchasingProcess</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">AliasDCI</span><span class="o">::</span><span class="no">Context</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">accounts</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assign_named_roles</span><span class="p">(</span><span class="ss">:customer</span>            <span class="o">=&gt;</span> <span class="n">user</span><span class="p">,</span>
</span><span class='line'>                       <span class="ss">:selected_product</span>    <span class="o">=&gt;</span> <span class="n">product</span><span class="p">,</span>
</span><span class='line'>                       <span class="ss">:accounts_department</span> <span class="o">=&gt;</span> <span class="n">accounts</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span>
</span><span class='line'>    <span class="n">in_context</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">customer</span><span class="o">.</span><span class="n">buy_product</span>
</span><span class='line'>      <span class="n">accounts_department</span><span class="o">.</span><span class="n">generate_invoice</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">role</span> <span class="ss">:customer</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">buy_product</span>
</span><span class='line'>      <span class="n">purchases</span> <span class="o">&lt;&lt;</span> <span class="n">selected_product</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">role</span> <span class="ss">:selected_product</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">invoice_desc</span>
</span><span class='line'>      <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">description</span><span class="si">}</span><span class="s2"> @ </span><span class="si">#{</span><span class="n">price</span><span class="si">}</span><span class="s2"> ea.&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">role</span> <span class="ss">:accounts_department</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">generate_invoice</span>
</span><span class='line'>      <span class="n">invoice</span> <span class="o">=</span>  <span class="no">Invoice</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">selected_product</span><span class="o">.</span><span class="n">invoice_desc</span><span class="p">,</span> <span class="n">total</span> <span class="p">)</span>
</span><span class='line'>      <span class="n">invoices</span> <span class="o">&lt;&lt;</span> <span class="n">invoice</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>My first thought looking at this was &#8220;WTF?&#8221;  This is <em>entirely</em> too complex for the task at hand.  It looks like it would be hard
to write, hard to test, and hard to read (not to mention <a href="http://tonyarcieri.com/dci-in-ruby-is-completely-broken">hard to execute</a>).</p>

<p>Why?</p>

<p>Let&#8217;s start with the definition of <code>call</code>, and let&#8217;s assume that we understand that <code>in_context</code> runs the code inside our &#8220;DCI
Container&#8221; that enables the DSL.  This is a big assumption, but I&#8217;ll make it.  The first call:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">customer</span><span class="o">.</span><span class="n">buy_product</span>
</span></code></pre></td></tr></table></div></figure>


<p>What is <code>customer</code>?  Where is it defined?  I see no method with that name.  I&#8217;ll need to understand that the hash given to
<code>assign_named_roles</code> renames the object given to the constructor.  OK, what about <code>buy_product</code>, the method that&#8217;s being called?</p>

<p>It&#8217;s not a method on <code>User</code>, so I&#8217;ll need to hunt down inside my class to find a definition, making sure to note if it is, or
is not, defined inside a <code>role :customer</code> block - presumably I could do <code>role :foobar</code> and define a method <code>buy_product</code> and that
would <em>not</em> be what I&#8217;m looking for.</p>

<p>Looking at that method, I see that it&#8217;s mutating an array called <code>purchases</code>, giving it the value of <code>selected_product</code>.
<code>purchases</code> is <em>not</em> a role, nor was it passed to <code>assign_named_roles</code>, so where is <em>it</em> coming from?</p>

<p>Turns out, it&#8217;s an attribute of <code>User</code> and that the method definition we are reading is being executed inside the binding of the <code>User</code> instance passed to the constructor.  Finally, we see that that <code>selected_product</code> <em>is</em> a role, an instance of <code>Product</code>.</p>

<p>One line down, one to go.  Whew!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">accounts_department</span><span class="o">.</span><span class="n">generate_invoice</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, we confirm that <code>accounts_department</code> is not a method defined locally, but is an instance of <code>Accounts</code> set up in the constructor. The method <code>generate_invoice</code> is a method defined at the bottom of our class presumably added to the <code>Accounts</code> instance by the DSL.  As before, <code>invoices</code> is an attribute of <code>Accounts</code>, and our method is executing inside that binding, which we just have to remember to piece together.</p>

<p>And this is for a <em>two line method</em> in a <em>very simplified domain</em>.  Exactly <strong>how</strong> is this supposed to make my job of reading
and writing code easier?!  And how the heck do we test all this?  <em>More</em> DSLs?</p>

<p>rebo states his case for this complexity and insanity by showing some &#8220;fat model&#8221; code as well as some unscoped &#8220;glue code&#8221; that
implements this use case.  This code is, indeed bad, too.  It puts logic on the models that really don&#8217;t belong there.  Can we do better?  Yes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PurchasingProcess</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">purchase_product</span><span class="p">(</span><span class="n">customer</span><span class="p">,</span><span class="n">product</span><span class="p">,</span><span class="n">accounts</span><span class="p">)</span>
</span><span class='line'>    <span class="n">customer</span><span class="o">.</span><span class="n">purchases</span> <span class="o">&lt;&lt;</span> <span class="n">product</span>
</span><span class='line'>    <span class="n">invoice_desc</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">invoice</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">#{</span><span class="n">invoice</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2"> @ </span><span class="si">#{</span><span class="n">invoice</span><span class="o">.</span><span class="n">price</span><span class="si">}</span><span class="s2"> ea.&quot;</span>
</span><span class='line'>    <span class="n">accounts</span><span class="o">.</span><span class="n">invoices</span> <span class="o">&lt;&lt;</span> <span class="no">Invoice</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">address</span><span class="p">,</span><span class="n">invoice_desc</span><span class="p">,</span> <span class="n">invoice</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Yup. Instead of bringing in a complex framework, confusing monkeypatching, and dynamic methods created in non-obvious bindings, I
just <em>made a class</em> that implements the <em>business logic</em>, and write the requisite three lines of code.</p>

<p>I didn&#8217;t have to change the core business objects, nor should I have - the format of <code>invoice_desc</code> is, so far, particular to
this use case, and needn&#8217;t be part of the <code>Invoice</code> class.  To understand this, we don&#8217;t need to leap too far: the <code>customer</code> is a
customer that we know contains <code>purchases</code>.  We add the passed <code>Purchase</code> instance, <code>purchases</code>, to that, then construct a
description of the invoice before adding a new invoice to the <code>accounts</code> instance we were given.</p>

<p>The method that implements our business logic is all based on parameters or local variables - there is no global or class-level
state to worry about, and each object is named for the type of class it is - no need to mentally translate when reading the code.
Assuming you understand what the core domain objects are, you can read and comprehend this entire business process on a VT100
terminal (if you had to).</p>

<p>If this business process needs to get more complex, we can use method extraction as a first step to fight complexity, and could
just <em>make more classes</em> if it gets worse. If it turns out that <em>another</em> business process needs to share some of this logic <em>by
design</em>, we can just apply <a href="http://www.naildrivin5.com/blog/2012/12/19/re-use-in-oo-inheritance.html">other methods of re-use</a> to deal with it then.</p>

<p>So, what is so wrong with this that we need some complex container to manage what should be just a few lines of code?  I do not
know.  I&#8217;m willing to concede this as a straw man argument, to a certain degree, but I&#8217;m still waiting to see how DCI is an
improvement over basic structured programming.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[&dagger; DHH on Hypermedia Hype]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/12/20/dhh-on-hypermedia-hype.html"/>
    <updated>2012-12-20T12:45:00-05:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/12/20/dhh-on-hypermedia-hype</id>
    <content type="html"><![CDATA[<p>The ever-opinionated DHH, <a href="http://37signals.com/svn/posts/3373-getting-hyper-about-hypermedia-apis">on the &#8220;hype&#8221; about &#8220;hypermedia&#8221; APIs</a>:</p>

<blockquote><p>The recurrent hoopla over hypermedia APIs is completely overblown. Embedding URLs instead of IDs is not going to guard you from breakage, it’s not going to do anything materially useful for standardizing API clients, and it doesn’t do much for discoverability.</p></blockquote>


<p>Couldn&#8217;t agree more. Just getting developers to consume an API that isn&#8217;t all POSTs is hard enough.  If &#8220;hypermedia&#8221; has
demonstrable benefits, I certainly have never seen proof of this, outside of a lot of exasperated flailing.</p>

<p>Remember when &#8220;Hypermedia APIs&#8221; were called REST?  I do.  From <a href="http://www.naildrivin5.com/blog/2009/03/17/mustbecompliant.html">my post</a> about this in <em>2009</em>:</p>

<blockquote><p><strong>Rest Compliance Officer</strong>: Is there exactly one endpoint, from which any and all resource locators are discoverable?<br><br/><strong>Me</strong>: Um, no, that puts undue burden on the client libraries, and over-complicates what we were trying to accomp&hellip;.<br><br/><strong>RCO</strong>: YOU ARE NOT RESTFUL! READ FIELDING’S DISSERTATION, THE HTTP SPEC AND IMPLEMENT AN RFC-COMPLIANT URI PARSER IN THREE DIFFERENT LANGUAGES. NEXT!<br></p></blockquote>


<p>Using HTTP methods for their intention is great, as is sane URL design, but the fantasy of a generic client that can discover and
navigate every possible operation of a web UI seems like just that&hellip;fantasy.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Re-use in OO: Inheritance, Composition and Mixins]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/12/19/re-use-in-oo-inheritance.html"/>
    <updated>2012-12-19T09:30:00-05:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/12/19/re-use-in-oo-inheritance</id>
    <content type="html"><![CDATA[<p>Over the past several months, the Rails community, at least to my eyes, has become increasingly concerned with managing the
complexity that appears when following the &#8220;fat model, skinny controller&#8221; advice prescribed my many Rails experts.  The real
issue, however, is <em>reusability</em>.  How can logic be easily used in two places?  In your average object-oriented language, there
are four primary ways to accomplish this:</p>

<ul>
<li>Copy and Paste</li>
<li>Inheritance</li>
<li>Composition</li>
<li>Mixins</li>
</ul>


<p>None are so superior to the other as to always be applicable, so how can we know when to use one over the others?</p>

<!-- more -->


<p>We re-use code to avoid duplication, yes, but also to get our jobs done more quickly.  The form of our re-use is important,
as it has the capability to change the way we&#8217;ve modeled our solution in code.  And the way we model our solution in an
object-oriented language is via classes, or types.  We create classes that represent various domain concepts, and each class
forms a <em>type</em> that describes what is, and is not, part of that domain concept.</p>

<p>Before we get into that, it&#8217;s worth talking about the most basic form of code re-use - one that we&#8217;ve all certainly used before:
copy and paste.</p>

<h2>Copy and Paste</h2>

<p>Copy and paste is usually a sign of <a href="http://www.naildrivin5.com/blog/2012/10/05/making-it-right-technical-debt-vs-slop.html">sloppy code</a>, however there are two forms of re-use where copy and paste is
acceptable.  The first form, which I&#8217;ll call <em>Stackus Overflowus</em> is when you find a snippet of code somewhere that solves a
problem at hand, and copy it into your codebase.  Usually, it&#8217;s a small amount of code for which there is no obvious library you
can pull in, and you only need said code in one location in your app.  Copy and paste is the quickest way to move on, and,
assuming the code is &#8220;universal&#8221;, is unlikely to need to be updated later.</p>

<p>The second is more subtle and rare.  Suppose you have two bits of logic in your app that are identical but that are concerned
with entirely different domain concepts or business processes - the code is the same <em>by happenstance</em>.  Will it improve the
codebase to extract this duplicated logic somewhere?  What if these already different business processes diverge further?  Now,
you have to deal with making your extracted, <a href="http://en.wikipedia.org/wiki/Don't_repeat_yourself">&#8220;DRY&#8221;</a> code deal with this divergeance.</p>

<p>You can actually make your app <em>harder</em> to change by &#8220;drying up&#8221; code that really isn&#8217;t <em>the same by design</em>.  But, in my
experience, this is rare.</p>

<p>More common in OO systems is inheritance.</p>

<h2>Inheritance</h2>

<p>Wikipedia defines <a href="http://en.wikipedia.org/wiki/Inheritance_(computer_science)">inheritance</a> as:</p>

<blockquote><p> a way to reuse code of existing objects, or to establish a subtype from an existing object, or both</p></blockquote>

<p>I&#8217;m going to assume <em>single</em> inheritance here, as that is common in common OO languages, and this means that a class only has one
supertype - you get one class as your base class, and that&#8217;s it.</p>

<p>Re-use via inheritance is the most far-reaching and drastic - your new subclass gets the entire public interface of the
superclass, plus whatever public interface it exposes on its own - as well as all the private methods and members.  It&#8217;s copy and
paste performed by the compiler or runtime.</p>

<p>Inheritance also makes a design statement - it says that the new subclass <em>is a type of</em> the superclass.  The new class is a more
specialized, less abstract version of the superclass.  The runtime should treat instances of the subclass the same as instances
of the superclass.</p>

<p>Often, however, we subclass to simply pull in code we&#8217;d like to re-use.  In a rails app, all controllers inherit from
<code>ApplicationController</code>.  In an aging, complex Rails app, <code>ApplicationController</code> becomes a dumping ground of random methods that
are needed by &#8220;a lot&#8221; of controllers - it&#8217;s effectively a global scope for code that doesn&#8217;t have an obvious place to go.</p>

<p>On good days, inheritance is a powerful tool to describe the types that make up your system.  Code can be re-used and customized,
often in ways not intended by the designer of the super class.  This can be very powerful, but it can also lead to a mess.
Further, it can be hard to test classes that re-use code from a superclass - just try to test an active record object without
having access to the database.</p>

<p>Finally, inheritance brings a public interface to your subclass that you may not want.  Each time you subclass, you create a
class with more public methods, which actually can <em>dilute</em> the very types you are trying to create.</p>

<p>In a language like Ruby or Scala, where we have mixins (see below), I find inheritance to be useful only when I&#8217;m truly defining
a hierarchy of types - when I want to say &#8220;here is a generic type, and I&#8217;m going to make some specializations of it to avoid
massive <code>if</code> statements all over my code&#8221;, or when I need to customize a type I didn&#8217;t create, for the purposes of using it with
code expecting the original type.</p>

<p>To get around the limitations of inheritance, the most obvious alternative is to use composition.</p>

<h2>Composition</h2>

<p><em>Composition</em>, as <a href="http://en.wikipedia.org/wiki/Composite_reuse_principle">defined by Wikipedia</a> is:</p>

<blockquote><p>a technique by which classes may achieve polymorphic behavior and code reuse by containing other classes that implement the desired functionality instead of through inheritance.</p></blockquote>

<p>This definition is focused on where the implementation of a particular public interface lives.  With inheritance, we present a
public interface whose implementation is provided by the superclass.  Here, it&#8217;s done via &#8220;some other class&#8221;.  In a statically
typed language like Java, composition is a pain - you have to define all the methods and proxy their calls to the composed class.
For a dynamic language like Ruby, classes like <code>Delegator</code> or a well-crafted <code>method_missing</code> can make this a snap.</p>

<p>But we&#8217;re talking about code-reuse here.  As it applies to code re-use, the term &#8220;composition&#8221; colloquially means &#8220;call methods on
a private object&#8221;.  In other words, if I want to re-use some shared logic, I put that logic in a class, create an object of that
class, and call its methods.</p>

<p>This has the advantage of being easy to implement and easy to understand - it&#8217;s probably what an inexperienced person would do if
they didn&#8217;t know about inheritance.  Using composition in this way doesn&#8217;t affect our types - our class&#8217; public
interface remains unchanged - and doesn&#8217;t require fitting our model into some complex hierarchy.</p>

<p>This technique has a few downsides:</p>

<ul>
<li>method calls are on some object, making them more verbose</li>
<li>if we create said objects as needed, we make isolated testing clumsy, difficult, or even impossible</li>
<li>if we instead use <a href="http://en.wikipedia.org/wiki/Inversion_of_control">inversion of control</a> and let someone else give us the objects we need, we now have to have some &#8220;container&#8221; to &#8220;wire up&#8221; all of these dependencies.</li>
</ul>


<p>The last two issues are particularly dicey.  In your average Java app, using externally configured dependency injection is the
defacto standard, so you get used to writing classes based on inversion of control.  In Ruby or Rails, this is not the way things work, and adding this &#8220;object container&#8221; just feels wrong.  The &#8220;container&#8221; adds complexity that we&#8217;d like to avoid, even if it affords us easier isolated testing.</p>

<p>Is there a way to avoid the issues and restrictions around inheritance, but without the baggage of composition?  There is:
mixins.</p>

<h2>Mixins</h2>

<p>Back on Wikipedia, a <a href="http://en.wikipedia.org/wiki/Mixins">mixin</a> is defined as:</p>

<blockquote><p>a class that provides a certain functionality to be inherited or just reused by a subclass, while not meant for instantiation</p></blockquote>

<p>This is a bit vague, but the idea is that we can &#8220;mix in&#8221; methods from one class into another without creating a rigid, single
&#8220;is a&#8221; relationship, but without <em>also</em> having to use complex delegation to a composed object.</p>

<p>Ruby uses modules for mixins, and Scala uses traits.  Neither are technically classes, but they <em>are</em> types.</p>

<p>The way in which code is re-used from a mixin is identical to the way it&#8217;s done via inheritance - the methods magically appear as
if part of the class.  This goes for both private/protected members <em>and</em> public members.  You can also mixin as many
modules/traits as you like - there&#8217;s no practical limit.</p>

<p>In DHH&#8217;s <a href="http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns">blog post</a>, he creates a mixin called <code>Taggable</code> that represents &#8220;a thing that has tags&#8221;.  This allows you to create a single bit of code for whatever it means to have tags, and to re-use it across the system.  He describes a second mixin called <code>Visible</code> that works similarly, before describing how we might use both of those in the same class.</p>

<p>This has a lot of positive effects:</p>

<ul>
<li>A single place for shared logic</li>
<li>Said logic is available expediently - no need to call methods on another object</li>
<li>No need to manage instances of other objects or worry about inversion of control</li>
<li>Isolated testing is much simpler than with inheritance</li>
</ul>


<p>This sounds like a pretty awesome solution to the problems presented by both inheritance and composition.  So, what&#8217;s the
problem?</p>

<p>The &#8220;abuse cases&#8221; of mixins are particularly annoying.  Case #1 involves including &#8220;too many&#8221; mixins.  Since a mixin can contain
public members, namely methods, a class with a lot of mixins will have a very large public footprint.  The resulting
objects begin to move away from a &#8220;type&#8221; toward a &#8220;god object&#8221;.  The rules of coupling and cohesion start to come into
play, and you can end up with a system where changes to a module that&#8217;s frequently included can have disastrous effects.  Making
this mess with inheritance or composition is <em>much</em> more difficult.</p>

<p>Of course, no technique should be dismissed because those with bad design taste abuse it.  I find a good rule of thumb is in how
these mixins are named. Mixins names should adjectives, not nouns or verbs.  Although DHH refers to this pattern as &#8220;concerns&#8221;,
you&#8217;ll notice that none of his mixins are named &#8220;Concerns&#8221;. He doesn&#8217;t have a <code>PersonConcerns</code> module, but instead has
modules for various features to be added.  If you can&#8217;t name your mixins as adjectives, you might be doing something wrong, and
if your mixin has the word &#8220;Concerns&#8221; in it - you&#8217;ve definitely screwed up.</p>

<p>Abuse case #2 is a misguided attempt at code organization.  To feel better about creating bloated god
objects, developers will extract groups of possibly-related functionality into a mixin and then mix it into the main class.  This
is hiding the problem of a bloated class that does too much.  Preventing this is easy - if your mixin isn&#8217;t being used by more than
one class then it should not have been extracted (the naming rule helps, too - if you can&#8217;t name something you&#8217;re less likely to
extract it)</p>

<p>There&#8217;s an interesting footnote of sorts to this technique, and that is DCI - Data, Context, and Integration.</p>

<h2>I really don&#8217;t understand DCI, but</h2>

<p>Jim Gay&#8217;s <a href="http://clean-ruby.com">Clean Ruby</a> is an in-progress treatise on the DCI, and I&#8217;ve not read the entire thing, nor will I claim to understand DCI beyond examples I&#8217;ve read, including <a href="http://saturnflyer.com/blog/jim/2011/10/04/oop-dci-and-ruby-what-your-system-is-vs-what-your-system-does/">Jim&#8217;s recent post</a>.  But the examples are interesting.</p>

<p>In the classic use of mixins, one declares the modules to be mixed-in as part of the class definition.  In the examples around
DCI, however, one mixes-in the needed code <em>only when needed</em>.  So, a <code>Person</code> that might need tagging would only have <code>Taggable</code> mixed in when code requires the ability to tag a person.  By default, a <code>Person</code> would not be taggable.  In Ruby, this might look like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">person</span><span class="o">.</span><span class="n">respond_to?</span> <span class="ss">:tag_names</span> <span class="c1"># =&gt; false</span>
</span><span class='line'><span class="n">person</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="no">Taggable</span><span class="p">)</span>
</span><span class='line'><span class="n">person</span><span class="o">.</span><span class="n">respond_to?</span> <span class="ss">:tag_names</span> <span class="c1"># =&gt; true</span>
</span></code></pre></td></tr></table></div></figure>


<p>This sort of dynamic type manipulation is not possible in every language, but it seems interesting to me.  Although it has some
abuse cases that seem equally horrible to those of vanilla mixins, I can think of some legacy code that could&#8217;ve done well to
have code organized this way.  With &#8220;call-time mixins&#8221;, developers could add features to core objects with relative
impunity, safe that their new changes wouldn&#8217;t cause regressions across the system.  The idea is you add mixins for &#8220;use cases&#8221; or &#8220;roles&#8221; and that existing code, not needing these roles, will work as before, even if code somewhere else dynamically mixes in this new code.</p>

<p>At first blush, this seems like a great way to tame complexity in legacy apps where good design has gone out the window, and
line after line of legacy code has been dropped into core classes.  For a greenfield application, with careful attention to
design and code cleanliness, this seems like less of a win to me, and would lead to more &#8220;surprising&#8221; code.
But, I haven&#8217;t read all of Jim&#8217;s book, yet, so I look forward to him making the case.</p>

<h2>So, always use mixins?</h2>

<p>Mixins <em>do</em> hit a sweet spot, practically speaking, but they aren&#8217;t a panacea.  Here&#8217;s my rules of thumb:</p>

<ul>
<li>Is the re-use concept an adjective?  Is it needed across the system by disparate classes?  Might be a mixin.</li>
<li>Is the re-use concept a refinement, specialization, or customization of an existing type?  Might be time for inheritance.</li>
<li>Can&#8217;t figure out <em>what</em> to do? Use composition.  Composition is <em>always</em> safe because it&#8217;s simple to create and use, even if
it&#8217;s more verbose.  Better to use composition when a mixin would do than to create a poorly-conceived mixin.</li>
<li>Please be wary of copy and paste.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why you can't refactor test code]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/11/16/why-you-cant-refactor-test-code.html"/>
    <updated>2012-11-16T11:18:00-05:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/11/16/why-you-cant-refactor-test-code</id>
    <content type="html"><![CDATA[<p>Was having a discussion with <a href="http://www.twitter.com/mikegehard">Mike Gehard</a>, <a href="http://www.twitter.com/fooblahblah">Jeff Simpson</a>, and <a href="http://www.twitter.com/boulderdanh">Dan Hopkins</a> about <a href="http://www.twitter.com/danmayer">Dan Mayer&#8217;s</a> <a href="http://mayerdan.com/ruby/2012/11/11/bugs-per-line-of-code-ratio/">excellent post</a>, and we go on the topic of refactoring test code.  My assertion is that you cannot, technically speaking, refactor test code, because you have no tests of the test code.  <a href="http://en.wikipedia.org/wiki/Code_refactoring"><em>Refactoring</em></a> cannot be done without tests that assert that the changes you&#8217;ve made haven&#8217;t introduced problems.</p>

<p>The discussion put forth a few such tests of tests code, such as running it on prod, having the tests continue to pass, or measuring coverage.  Unfortunately, none of these are sufficient to call changes in test code a <em>refactoring</em>.  I would call it a <em>rewrite</em> or <em>redesign</em>, and I think that the distinction is important.</p>

<!-- more -->


<h2>Refactoring</h2>

<p>A <em>refactoring</em> is <em>very</em> safe (not 100% safe), because you have tests.  A <em>rewrite</em> is unsafe, because you don&#8217;t have that safety net.  You can rewrite test code, yet tests can continue to pass, and coverage can remain the same, in the face of a mistake.  I&#8217;m not saying you shouldn&#8217;t rewrite your tests to make them cleaner, but you should be honest that what you are doing is different from a code refactoring - namely riskier.  Let&#8217;s demonstrate.</p>

<h2>Example</h2>

<p>Consider a very simple domain of a person, that has a greeting and can possibly buy booze.  We have a lovely special case that anyone with a name ending in &#8220;Kennedy&#8221; can buy booze, but everyone else has to be 21.  I know this is contrived (sorry DHH), but it&#8217;s simple enough to grok and complex enough to demonstrate the issue.</p>

<p>Here&#8217;s our code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Person</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:gender</span><span class="p">,</span> <span class="ss">:birthdate</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span><span class="n">gender</span><span class="p">,</span><span class="n">birthdate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@name</span>      <span class="o">=</span> <span class="nb">name</span>
</span><span class='line'>    <span class="vi">@gender</span>    <span class="o">=</span> <span class="n">gender</span>
</span><span class='line'>    <span class="vi">@birthdate</span> <span class="o">=</span> <span class="n">birthdate</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">can_buy_booze?</span>
</span><span class='line'>    <span class="p">(</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="vi">@birthdate</span> <span class="o">&gt;=</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="p">)</span> <span class="o">||</span> <span class="nb">name</span> <span class="o">=~</span> <span class="sr">/Kennedy$/</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">greeting</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">gender</span>
</span><span class='line'>    <span class="k">when</span> <span class="ss">:male</span>   <span class="k">then</span> <span class="s2">&quot;Hello Mr. </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">when</span> <span class="ss">:female</span> <span class="k">then</span> <span class="s2">&quot;Hello Ms. </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">else</span>              <span class="s2">&quot;Hello </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And our test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PersonTest</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_accessors</span>
</span><span class='line'>    <span class="n">birthdate</span> <span class="o">=</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="n">birthdate</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="ss">:male</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">gender</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="n">birthdate</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">birthdate</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_can_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert</span> <span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_kennedy_can_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Joe Kennedy&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="mi">20</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert</span> <span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_cannot_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="mi">20</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert</span> <span class="o">!</span><span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_male_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello Mr. foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_female_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:female</span><span class="p">,</span><span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello Ms. foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_other_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:other</span><span class="p">,</span><span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The test clearly covers 100% of the <code>Person</code> class (even going so far as to test the accessors/constructor).</p>

<p>It also has a lot of repetition and irrelevant literals in it (see <a href="http://www.naildrivin5.com/blog/2012/02/16/even-more-clean-tests-magic-values.html">my post</a> on why this is bad).  Making new tests will require some copy and paste (in fact, I did a lot of copy and paste to write these tests).  Let&#8217;s &#8220;refactor&#8221; the test to clean some of this up.</p>

<h2>&#8220;Refactoring&#8221; our test</h2>

<p>We&#8217;ll create a method that makes <code>Person</code> instances (which is hand-rolled &#8220;factory&#8221; [which is really a prototype, but whatever FactoryGirl]), and uses &#8220;reasonable&#8221; values for anything that&#8217;s not needed specifically for the test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">some_person</span><span class="p">(</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{})</span>
</span><span class='line'>  <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">attributes</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>      <span class="o">||</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span>
</span><span class='line'>             <span class="n">attributes</span><span class="o">[</span><span class="ss">:gender</span><span class="o">]</span>    <span class="o">||</span> <span class="ss">:male</span><span class="p">,</span>
</span><span class='line'>             <span class="n">attributes</span><span class="o">[</span><span class="ss">:birthdate</span><span class="o">]</span> <span class="o">||</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can then clean up each test method, so that the only literals in each test are those relevant for the test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PersonTest</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_accessors</span>
</span><span class='line'>    <span class="n">birthdate</span> <span class="o">=</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="ss">:male</span><span class="p">,</span><span class="n">birthdate</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="ss">:male</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">gender</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="n">birthdate</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">birthdate</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_can_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span>
</span><span class='line'>    <span class="n">assert</span> <span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_kennedy_can_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span><span class="p">(</span><span class="ss">:name</span><span class="o">=&gt;</span> <span class="s2">&quot;Joe Kennedy&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert</span> <span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_cannot_buy_booze</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span><span class="p">(</span><span class="ss">:birthdate</span> <span class="o">=&gt;</span> <span class="mi">20</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert</span> <span class="o">!</span><span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_male_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello Mr. foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_female_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span><span class="p">(</span><span class="ss">:gender</span> <span class="o">=&gt;</span> <span class="ss">:female</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello Ms. foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_other_greeting</span>
</span><span class='line'>    <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span><span class="p">(</span><span class="ss">:gender</span> <span class="o">=&gt;</span> <span class="ss">:other</span><span class="p">)</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Hello foo&quot;</span><span class="p">,</span><span class="n">person</span><span class="o">.</span><span class="n">greeting</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">some_person</span><span class="p">(</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{})</span>
</span><span class='line'>    <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">attributes</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>      <span class="o">||</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span>
</span><span class='line'>               <span class="n">attributes</span><span class="o">[</span><span class="ss">:gender</span><span class="o">]</span>    <span class="o">||</span> <span class="ss">:male</span><span class="p">,</span>
</span><span class='line'>               <span class="n">attributes</span><span class="o">[</span><span class="ss">:birthdate</span><span class="o">]</span> <span class="o">||</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>All the tests still pass, and our code coverage (as reported by any reasonable open-source Ruby code coverage tool, which is to say line coverage) is still 100%.</p>

<p>We missed something, however.  Can you spot it?  We actually <strong>lost</strong> test coverage (which is to say &#8220;what code got executed&#8221;).</p>

<h2>In which we see our error</h2>

<p>Now let&#8217;s refactor the <code>Person</code> class, hoping that any mistakes we make will be demonstrated by our we-hope-it&#8217;s-equivalent-refactored test.  We&#8217;ll extract the &#8220;Kennedy&#8221; regexp into a constant.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Person</span>
</span><span class='line'>  <span class="no">CAN_DRINK_IF_YOUNGER</span> <span class="o">=</span> <span class="sr">/kennedy$/</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># omitted unchanged code...</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">can_buy_booze?</span>
</span><span class='line'>    <span class="p">(</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="vi">@birthdate</span> <span class="o">&gt;=</span> <span class="mi">21</span><span class="o">.</span><span class="n">years</span><span class="p">)</span> <span class="o">||</span> <span class="nb">name</span> <span class="o">=~</span> <span class="no">CAN_DRINK_IF_YOUNGER</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>You might notice that we screwed something up, but we rely on our tests, which all pass with flying colors. Coverage is still 100%, so we ship it.</p>

<p>But now our code is broken.  If we ran the <em>original</em> test, the test <code>test_kennedy_can_buy_booze</code> will fail, because the extracted regexp has a lower-case &#8216;k&#8217;, not an upper-case &#8216;k&#8217;. What happened?</p>

<p>The reason our &#8220;refactored&#8221; test didn&#8217;t catch it is that we messed up converting <code>test_kennedy_can_buy_booze</code>.  That test <em>should</em> have looked like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">test_kennedy_can_buy_booze</span>
</span><span class='line'>  <span class="n">person</span> <span class="o">=</span> <span class="n">some_person</span><span class="p">(</span><span class="ss">:name</span><span class="o">=&gt;</span> <span class="s2">&quot;Joe Kennedy&quot;</span><span class="p">,</span> <span class="ss">:birthdate</span> <span class="o">=&gt;</span> <span class="mi">20</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span>
</span><span class='line'>  <span class="c1">#                                            ^^^^^^^^^^^^^^^^^^^^^^^^^</span>
</span><span class='line'>  <span class="n">assert</span> <span class="n">person</span><span class="o">.</span><span class="n">can_buy_booze?</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>We needed to make the <code>Person</code> under 21 to trigger the special case of the name ending in <code>Kennedy</code>.  Instead, we accidentally relied on our prototype method, which uses a default age of 21, which is the age at which you can buy booze, regardless of your last name.</p>

<p>So, our tests passed every step of the way, but we a) lost test coverage and b) were able to introduce a bug.</p>

<p><em>This</em> is why I would not call the change we made to our tests a <em>refactoring</em>.  We simply have no way to know that the change we made didn&#8217;t break something.  I would say that we <em>rewrote</em> or <em>redesigned</em> the test.  The difference is important.</p>

<p>I&#8217;m also not saying that we shouldn&#8217;t change our tests to make them better, but doing so is a riskier process and is clearly <em>not</em> a refactoring.  It&#8217;s important that our terms of art are used accurately, as they convey, specifically, what we are doing.</p>

<h3>On the meaning of &#8220;coverage&#8221;</h3>

<p>Most code coverage tools report only on line coverage.  With an expressive language like Ruby, there&#8217;s a lot going on on each line of code.  To truly understand what parts of the code are executed, we need <a href="http://en.wikipedia.org/wiki/Code_coverage">condition coverage</a>.  If we had that, we could&#8217;ve seen that our &#8220;refactored&#8221; test no longer covered the second condition of our expression inside <code>can_buy_booze?</code>.  <strong>That</strong> being said, there could still be cases where a mistake in our test &#8220;refactoring&#8221; allowed bugs to creep in that would not have been possible otherwise.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[&#10106;&#10144; Making it Right: Technical Debt vs. Slop]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/10/05/making-it-right-technical-debt-vs-slop.html"/>
    <updated>2012-10-05T11:36:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/10/05/making-it-right-technical-debt-vs-slop</id>
    <content type="html"><![CDATA[<p>We were recently having a discussion at work about &#8220;doing it right&#8221; and &#8220;technical debt&#8221;.  The discussion revolved around the
optionality of &#8220;doing it right&#8221; - when is it OK to not &#8220;do it right&#8221;?</p>

<p>I would say it&#8217;s <strong>almost never</strong> OK to write code incorrectly.  If your understanding of what &#8220;doing it right&#8221;
means includes an &#8220;optional&#8221; clause, <strong>you have the wrong definition</strong>.  As professionals, we should always do it right.  We
should always do our work correctly.  I don&#8217;t mean we should over-engineer, nor do I mean that we should solve an abstract
problem instead of the one in front of us for &#8220;flexibility&#8221;, but we should have a basic standard that we inflexibly hold
ourselves to.</p>

<p>Writing code that <strong>does not</strong> adhere to our personal standards of correctness isn&#8217;t technical debt - it&#8217;s slop.</p>

<!-- more -->


<ul>
<li>Code with no tests isn&#8217;t technical debt, it&#8217;s slop.</li>
<li>Code that passes its test due to copy and paste isn&#8217;t technical debt, it&#8217;s slop.</li>
<li>Code with conditional expressions that wrap the screen isn&#8217;t technical debt, it&#8217;s slop.</li>
<li>Code that you write, without knowing <em>why</em>…it&#8217;s slop.</li>
</ul>


<p>The people who&#8217;ve paid for us to write code (which I will call <em>stakeholders</em> for lack of a better term), do not want slop, <em>even
if they don&#8217;t even know what that means</em>.  They want The Feature, the Whole Feature, and Nothing But The Feature, but they don&#8217;t
want it wrapped around a pile of shit.  And you know it.</p>

<p>Stakeholders trust us to do things correctly, and to not over-engineer some solution.  They trust us not to turn a boring problem
into an interesting one, and its our responsibility to deliver something done &#8220;right&#8221;.</p>

<h2>&#8220;Right&#8221; isn&#8217;t an option</h2>

<p>You must first absolve yourself of the notion that &#8220;doing it right&#8221; is optional.  Doing this requires you to do two things:</p>

<ul>
<li>Be honest with yourself about the differences between solving the problem in front of you in a clean way and turning that
problem into an architecture astronautic framework generified flexibilty extraction.  &#8220;Doing it right&#8221; doesn&#8217;t mean you get to
extract a framework at the end.  &#8220;Doing it right&#8221; doesn&#8217;t mean the code is now an open-source project.</li>
<li>Stand firm about the quality of work you will deliver.  You will not deliver slop.  Ever.  You are a professional who knows what you are
doing and you are paid a very high salary for that expertise.  Do not take a shit on it by delivering slop as completed work.</li>
</ul>


<h2>Holmes on Homes - Get in the mindset</h2>

<p>Coming to terms with what &#8220;doing it right&#8221; really means can be difficult, especially if you don&#8217;t have much experience.  Your instinct is to provide immediate gratification to a
stakeholder, and you might not truly understand the difference between &#8220;doing it right&#8221; and flying off with the Architecture
Astronauts.  We&#8217;ll get to some techniques to help.</p>

<p>But first, I&#8217;d encourage you to watch an episode of the HGTV television program <a href="http://www.hgtv.com/holmes-on-homes/show/index.html">Holmes on Homes</a>.  If you&#8217;ve ever spent time in someone else&#8217;s codebase, you will identify very closely with Mike Holmes (the host) and the problems he faces.  He&#8217;s called in to clean up a mess made by other home contractors.  His catch phrase is &#8220;make it right&#8221;.</p>

<p>Sometimes, Mike has to rip out entire rooms to fix a problem introduced by another contractor who took a shortcut, or did
something wrong.  Other times, he simply applies the right technique or tool for the job, at little additional cost over &#8220;the
quick and incorrect way&#8221; another contractor might.</p>

<p>It&#8217;s also important to note that Mike doesn&#8217;t turn one thing into another.  If a homeowner&#8217;s deck is faulty, he doesn&#8217;t give them
a screened-in porch.  He fixes the deck to make it right.</p>

<p>Watching the show, you will also begin to see how stakeholders view your work.  The homeowners (who are the stakeholders of these
projects) typically don&#8217;t have the technical
expertise necessary to examine the work they&#8217;ve paid for.  They will only ever see the finished veneer of a project, and trust
the contractor to have done the right thing underneath.  Sound familiar?</p>

<h2>Be the stakeholder</h2>

<p>Think about when <em>you&#8217;ve</em> been the stakeholder.  If you&#8217;ve hired a contractor to do some work, this is the perfect analog, though
if you&#8217;ve ever paid a CPA to do your taxes, hired a lawyer, or had surgery, you&#8217;ve been the stakeholder.  You have no idea how
the professional you&#8217;ve hired does their work, and while you want it done as quickly and cheaply as possible, you expect a certain
standard of quality.</p>

<p>Suppose you&#8217;re having something rewired in your hose and the electrician runs out of wire.  Suppose he sees that you have enough
speaker wire to finish the job, and offers to use that.  It&#8217;ll save you time and money.  Would you accept this?  Of course not,
and you&#8217;d be wise to treat everything this person says from then on with extreme suspicion.  They are offering you a
solution that is wrong, and presenting it with the same validity as the correct solution (going to the store to buy more
of the correct wire).</p>

<p>So, why are you offering your stakeholder, who&#8217;s put their trust in you, a cheap, easy, and dangerous way out?  Why present an
option that you know to be wrong?  Stakeholders want solutions, not decisions, and they don&#8217;t have the ability to make a
technical decision anyway - that&#8217;s why they hired you!</p>

<h2>How to make it right</h2>

<p>Here&#8217;s how to make it right, in four steps.</p>

<ol>
<li><strong>Think before you type</strong>.  Do you understand the problem you are solving?  How will you solve it?  What should the system
look like when it&#8217;s done?  Agile teaches us to avoid &#8220;Big Design Up Front&#8221;, but we&#8217;ve interpreted this as &#8220;JUST START
TYPING!!!!&#8221;.  Don&#8217;t just start typing.  Think.  Write something down if you need to.  It&#8217;s OK.  This is the hardest part to
remember to do.</li>
<li><strong>Write a test or tests</strong>.  Yup, write your tests first.  There&#8217;s a few reasons to do this.  First, you want a test to exist
when all is said and done, and writing it <em>right after you thought about the problem</em> is the best time to do so.  Second, you
want a way to run your code while you work on it.  An automated test, run from the command-line or your IDE is <strong>way</strong> easier
than manually doing it.  Finally, a test persists as your intention of how the system should work, and you <strong>already know how
it should work</strong>, so write it down now…as a test.  This is the hardest, most tedious step, so it&#8217;s nice to get it out of the
way early.</li>
<li><strong>Get it working</strong>.  As quickly as possible, make the test pass.  It can be sloppy. It can be less than ideal.  You can make a
mess.  What you want is to get the code into a shape where it does what you want it to do.  This should be the easiest part of
the process.  Any idiot can make code work.</li>
<li><strong>Make it right</strong>.  I&#8217;m not going to use the &#8220;R&#8221; word here.  In this step, you clean up the mess you made.  You remove duplicate code.  You change your print statements to log statements.  You extract your complex conditionals into methods.  You move unrelated code into new classes.  It&#8217;s fast.  It requires being creative, and is extremely satisfying.  Also, your brain is in the problem, so there&#8217;s no better time to do this than right now.  <strong>This is the most fun and rewarding part of writing a computer program</strong>.  That&#8217;s why it&#8217;s important, and that&#8217;s why we do it last.</li>
</ol>


<p>Repeat these steps until you&#8217;ve solved the problem in front of you.</p>

<h2>What about technical debt?</h2>

<ul>
<li>A shitty variable name isn&#8217;t technical debt, it&#8217;s slop.</li>
<li>Absent API documentation isn&#8217;t technical debt, it&#8217;s slop.</li>
</ul>


<p>Technical debt is an assumption you know does not hold (e.g. no user will buy more than three items at a time).  Technical debt
is a design decision you know to be less than optimal (e.g. we&#8217;ll special case these orders to use a different shipping provider
instead of creating a new shipping subsystem).  Technical debt is code to stop the bleeding of your business (e.g. shut off
all access to the beta site until this wave of users from TechCrunch has passed).  Technical debt is not sloppily written code.
It is clean code that is less than optimal.</p>

<p>When you acquire technical debt, <strong>write it the fuck down</strong>.  It&#8217;s <strong>that</strong> important.  Ideally, you would write it as a code
comment where the debt was acquired.  If that won&#8217;t work, include it as the commit message when you change the system.</p>

<p>And then add a new task to your task list to pay it off.</p>

<p>But always make it right.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GLI 2.0]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/08/19/gli-2-dot-0.html"/>
    <updated>2012-08-19T19:54:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/08/19/gli-2-dot-0</id>
    <content type="html"><![CDATA[<p><a href="http://davetron5000.github.com/gli">GLI</a> 2.0 is out!  GLI is <em>the best</em> way to make a &#8220;command-suite&#8221; command line interface.  If you need to make a complex
command line app that takes subcommands, like <code>git</code> or <code>gem</code>, GLI is the most powerful and easy-to-use way to do that.</p>

<!-- more -->


<p>Unlike <code>thor</code> or <code>trollop</code>, GLI sits on top of <code>OptionParser</code>, giving you access to its powerful features.  GLI-powered apps have
fully-featured help systems - you just need to provide a bit of documentation.  There&#8217;s also support for a basic application
lifecycle and with almost no code, you have an awesome, well-behaved command-line app that&#8217;s easy to write, easy to test, easy to
use, and easy to maintain.</p>

<h2>New Features</h2>

<ul>
<li>Arbitrarily deep sub- and sub-sub-commands.  Think <code>git remote add</code>.</li>
<li>Uses <code>OptionParser</code>, meaning your command-line options can benefit from type conversions, validation checks, negatability, and
all the other awesome that comes from <code>OptionParser</code>.</li>
<li>Whole new help system that shows command-line invocation examples, generated from your code.</li>
<li>Bootstrapped apps now include an <code>.rvmrc</code> and a shell for acceptance testing via <a href="https://github.com/cucumber/aruba">aruba</a>.</li>
<li>More flexible documentation-generation systems to allow any format of documentation to be generated (currently, only RDoc is
implemented).</li>
<li>More easily structure your code in external files</li>
<li>Lots of bug-fixes</li>
</ul>


<h2>Get Started</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&gt; gem install gli
</span><span class='line'>&gt; gli init your-new-app
</span></code></pre></td></tr></table></div></figure>


<h2>Learn More</h2>

<ul>
<li><a href="http://davetron5000.github.com/gli">Walkthrough</a> of GLI&#8217;s features at a more detailed level</li>
<li>A more sophisticated application with <a href="http://davetron5000.github.com/gli/todo.html">annotated source</a></li>
<li>Source code on <a href="http://www.github.com/davetron5000/gli">Github</a></li>
<li><a href="http://davetron5000.github.com/gli/rdoc">API Documentation</a></li>
<li><a href="http://www.pragprog.com/titles/dccar">Buy the book</a> - One of the running examples uses GLI, and the examples should all work with 2.0</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[&dagger; Hate COBOL, not Java?]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/08/13/hate-cobol-not-java.html"/>
    <updated>2012-08-13T09:14:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/08/13/hate-cobol-not-java</id>
    <content type="html"><![CDATA[<p>Another stinker from <a href="http://blog.jelastic.com">jelastic</a>, this time on how <a href="http://blog.jelastic.com/2012/08/13/hate-java/">Java&#8217;s not that bad</a>:</p>

<blockquote><p>So next week someone will invent another DSL that makes Twitter easier to use, but your bank will be writing new COBOL to more efficiently transfer funds to another Bank. We’re embarrassing ourselves with our petty arguments.</p></blockquote>


<p>So, because some industries are still using COBOL, we should stop advancing the state of the art, which involves moving onto more
modern languages than Java, and go help out these poor billion-dollar industries get into the cloud?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[&dagger; End of Rational Discourse?]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/08/10/end-of-rational-discourse.html"/>
    <updated>2012-08-10T08:56:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/08/10/end-of-rational-discourse</id>
    <content type="html"><![CDATA[<p><a href="https://plus.google.com/110981030061712822816/posts">Steve Yegge</a> has an interesting post up, that classifies programmers along the <a href="https://plus.google.com/110981030061712822816/posts/KaSKeg4vQtz">conservative-to-liberal</a> axis
(which is, ironically, completely useless in classifying real people&#8217;s political feelings):</p>

<blockquote><p>I think that my conceptual framework gives us an &#8220;out&#8221; &#8211; a way to avoid being emotional about these subjects. Casting the problem as a clash between Liberalism and Conservatism gives us the ultimate ticket for &#8220;agreeing to disagree&#8221;.</p></blockquote>


<p>The way to avoid being emotional is to…avoid being emotional.  I think that casting the problem as some unchangeable political &#8220;stance&#8221; is lazy thinking, and gives use the ultimate ticket for avoiding any real discussion.  This way of thinking seems most useful in dismissing arguments one doesn&#8217;t feel like thinking too hard about.</p>

<p>Honestly, if you can&#8217;t have a real discussion about the pros and cons of e.g. static typing, you either have a lot to learn, or
are not a very capable developer.  If your best answer to &#8220;Can we use Ruby on this project?&#8221; is &#8220;oh, we&#8217;re Conservative, so…no&#8221;, then you are either have a lot to learn or you are an asshole.  If you refuse to even discuss what the benefits of explicit, yet verbose code are over implicit, but compact code, then you are either have a lot to learn or are an asshole<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>.</p>

<p>As developers, we&#8217;re blessed to work in a field full of objective truths.  To avoid seeking them out under the guise of immutable
political stances is the epitome of anti-intellectualism.</p>

<hr />

<div class="footnotes">
    <ol>
        <li id='fn:1'>I would make the same conclusion for the opposite: you should be able to discuss the benefits of implicit, terse code over explict, verbose code, too. <a href='#fnref:1' rev='footnote'>↩</a></li>
    </ol>
</div>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Running Stock]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/08/02/running-stock.html"/>
    <updated>2012-08-02T09:55:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/08/02/running-stock</id>
    <content type="html"><![CDATA[<p>One of my fellow developers asked me the other day if I had any good dotfiles for <code>bash</code>.  I realized I don&#8217;t.  I don&#8217;t even have <code>ll</code> aliased to <code>ls -l</code> like most of the known universe.  I realized that I like to run as stock as I can.</p>

<!-- more -->


<p>Here&#8217;s what I have aliased in <code>bash</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">alias </span><span class="nv">vi</span><span class="o">=</span><span class="s1">&#39;mvim&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">ps</span><span class="o">=</span><span class="s1">&#39;ps auxwwwwwwww&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">ls</span><span class="o">=</span><span class="s1">&#39;ls -FG&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">irb</span><span class="o">=</span>pry
</span></code></pre></td></tr></table></div></figure>


<p>That&#8217;s <strong>it</strong>.  I type <code>bundle exec</code> if I have to (and always in anger).  I have a function called <code>go</code> that sets up a few things for working on a particular project (e.g. <code>go gli</code> before I start working on <a href="http://davetron5000.github.com/gli">gli</a>), but otherwise, I type the commands as
they come and use whatever options I need at the time, even if I tend to use the same options a lot (e.g. <code>grep -r</code>).</p>

<p>Over the years, my muscle memory has evolved around <em>just using the shell as it is</em> and not wound around a lot of customizations.  As such, when I&#8217;m tunneled into some production server, or other location where I don&#8217;t have my dotfiles (such as another
developer&#8217;s box), I&#8217;m almost exactly as proficient as I am in my own environment.</p>

<p>Sure, it takes some probably-measurable amount of time to type <code>bundle exec</code> or <code>ls -l</code> instead of <code>bx</code> or <code>ll</code>, but I find I don&#8217;t spend a lot of my time typing things.  I spend most of it reading and thinking, and there&#8217;s really no shortcut for that.</p>

<p>Similarly, my global <code>git</code> config contains only one alias: <code>lol</code>, which shows logs on one line (<code>log --oneline --graph --decorate</code>).</p>

<p>My <code>.vimrc</code> is a bit of an exception, as I have a fair amount of default configuration overridden, but in terms of mappings, I still don&#8217;t have that much set up.  I use <a href="https://github.com/tpope/vim-pathogen/">pathogen</a> plugins and know the shortcuts many of them provide (like the amazing <a href="https://github.com/tpope/vim-rails">rails.vim</a>), but I don&#8217;t tend to customize them that much.  Here&#8217;s all the
mappings I have setup:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="s2">&quot; cd to directory of current file</span>
</span><span class='line'><span class="s2">map c :cd %:p:h</span>
</span><span class='line'><span class="s2">&quot;</span> open buffer list
</span><span class='line'>map b n<span class="se">\b</span>e
</span><span class='line'><span class="s2">&quot; next error</span>
</span><span class='line'><span class="s2">map   :cnext</span>
</span><span class='line'><span class="s2">&quot;</span> fold this line
</span><span class='line'>map f !!fold -w77 -s
</span><span class='line'><span class="s2">&quot; ^O tries to open the thing under the cursor using gf</span>
</span><span class='line'><span class="s2">map  sgf</span>
</span><span class='line'><span class="s2">&quot;</span> Avoid annoying ^Z minimizing to nowhere
</span><span class='line'>map  
</span></code></pre></td></tr></table></div></figure>


<p>Again, that&#8217;s <strong>it</strong>.  Whenever I&#8217;m in <code>vi</code>, <em>anywhere</em>, I&#8217;m 99% effective.</p>

<p>I tend to automate things away when they become annoying, so I guess I don&#8217;t tend to get annoyed by typing small words into the terminal.  My brain thinks in chunks of words, which is why I dislike abbreviations and acronyms.  They seem like a vestige of
the days when we had to write things instead of auto-complete them.</p>

<p>Anyway, I&#8217;d recommend all developers try to run as stock as possible.  I bet you won&#8217;t be as slowed down as you think, and you won&#8217;t feel hamstrung in an environment you can&#8217;t totally control.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[&dagger; Hungry Academy graduates]]></title>
    <link href="http://www.naildrivin5.com/blog/2012/07/30/hungry-academy-graduates.html"/>
    <updated>2012-07-30T09:41:00-04:00</updated>
    <id>http://www.naildrivin5.com/blog/2012/07/30/hungry-academy-graduates</id>
    <content type="html"><![CDATA[<p>An <a href="http://www.washingtonpost.com/business/capitalbusiness/with-hungry-academy-livingsocial-aims-to-build-its-own-techies/2012/07/29/gJQAH5Q2IX_story.html">article in the Washington Post</a> gives a good summary of <a href="http://hungryacademy.com/">Hungry Academy</a>, LivingSocial&#8217;s experiment to train 24
motivated people to become fully-functional developers in just five months.  They worked hard and <strong>all</strong> graduated last week,
starting as official developers over the next week.</p>

<blockquote><p>The benefit, if all goes according to plan, however, is a fleet of engineers that can be hired en masse with a commitment to work at LivingSocial for at least 18 months. Unlike fresh hires, the academy students are already familiar with the company’s products and culture.</p></blockquote>


<p>The 2-3-week-long projects they delivered over the course were impressive enough, but given that many of them didn&#8217;t have any
professional programming skills beforehand, their progress has been amazing to watch.  The first half of this grand experiment is
over and it was a rousing success.  The second half - how well they succeed in the actual work environment - begins now.  I&#8217;m optimistic.</p>
]]></content>
  </entry>
  
</feed>
